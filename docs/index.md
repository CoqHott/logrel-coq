Browsing the sources
============================

The table of content of the development is accessible [here](./coqdoc/toc.html).

File description
==========

To complement it, here is a rough description of the content of every file.

Partial functions library ([coq-partialfun folder](../coq-partialfun/theories))
----------------
This part of the repository is due to [Winterhalter](https://github.com/TheoWinterhalter/coq-partialfun), 
we simply reproduce it here with minimal changes in the absence of an opam package.

| File | Description |
|---|----|
| [Monad] | Monad and the error monad transformer, with notations.
| [PartialFun] | Support for the definition of potentially non-terminating recursive functions.
| Examples | Simple usage examples of the library.

Miscellaneous
---------

| File | Description |
|---|----|
[mapPiSigmaFunctorLaws] | Shows that `mapΠ` and `mapΣ` are definable in Coq and satisfy the definitional functor laws.

Utilities and AST
---------

| File | Description |
|---|----|
[Utils] | Basic generically useful definitions, notations, tactics…
[BasicAst] | Definitions preceding those of the AST of terms: sorts, binder annotations…
[AutoSubst/] | Abstract syntax tree, renamings, substitutions and many lemmas, generated using the [autosubst-ocaml] opam package.
[AutoSubst/Extra] | Extra instances, notations and tactics to better handle the boilerplate generated by AutoSubst.
[Notations] | Notations used throughout the development. It can be used as an index for notations!
[NormalForms] | Definition of normal and neutral forms, and properties.

Common typing-related definitions
-------

| File | Description |
|---|----|
[Context] | Definition of contexts and operations on them.
[Weakening] | Definition of a well-formed weakening, and some properties.
[UntypedReduction] | Definiton and basic properties of (untyped) reduction, used to define algorithmic typing and the logical relation.
[GenericTyping] | A generic notion of typing, used to define the logical relation, to be instantiated three times: once with the fully declarative version, once with the mixed declarative and algorithmic one, and once with the fully algorithmic one.

Declarative typing and its properties
--------------

| File | Description |
|---|----|
[DeclarativeTyping] | Defines the theory's typing rules in a declarative fashion, the current definition has a single universe as well as product types and eta-conversion for functions. |
[DeclarativeInstance] | Proof that declarative typing is an instance of generic typing. |

Logical relation and its properties
-----------

| File | Description |
|---|----|
[LogicalRelation] | Contains the logical relation's definition. |
[Induction] | Defines the induction principles for the logical relation. These are manual hand-crafted induction principles, that suit our needs better than the ones automatically generated by Coq. |
[Escape] | The escape lemma for the logical relation says that predicates in the logical relation imply their generic typing counterparts: a reducible type is a well-formed type, reducibly convertible terms are convertible, etc. |
[ShapeView] | Technique to avoid considering non-diagonal cases for two reducibly convertible types. |
[LogicalRelation.Reflexivity] | Reflexivity of the logical relation.
[LogicalRelation.Irrelevance] | Irrelevance of the logical relation: two reducibly convertible types decode to equivalent predicates. Symmetry is a direct corollary. |
[Weakening] | Stability of the logical relation under weakening |
[Universe] | The universe is reducible |
[Neutral] | Well-typed neutrals are reducible at any type. |
[Transitivity] | The logical relation is transitive. |
[Reduction] | Reducible terms and types are stable under anti-reduction and reduction to weak-head normal form, and reduction of reducible terms/types in included in reducible conversion. |
[NormalRed] | Normalization of the proof-relevant components of proofs of reducibility. |
[Application] | Function application is reducible. |
[SimpleArr] | Non-dependent function types are reducible. |
[Validity] | Definition of **validity**: free closure of the logical relation under reducible substitution, necessary to handle the interaction of reducibility and binders. |
[Substitution.Irrelevance] | Irrelevance of validity. |
[Substitution.Properties] | Interaction of validity with context/substitution operations: weakening, extension, etc. |
[Substitution.Escape] | Escape for validity. |
[Substitution.Conversion] | Stability of validity by conversion. |
[Substitution.Reflexivity] | Reflexivity of validity. |
[Substitution.Reduction] | Stability of validity under reduction. |
[SingleSubst] | Recovering properties of unary substitution from those of n-ary substitution. |
[Substitution.Introductions.*] | Reducibilty of the various term- and type-formers. |
[Fundamental] | Fundamental lemma : every typable term is reducible. Combines most of the development above. |


Algorithmic typing and its properties
-----------------

| File | Description |
|---|----|
[DeclarativeSubst] | Consequence of the logical relation: declarative typing is stable under substitution.
[TypeConstructorsInj] | Consequence of the logical relation: type constructors are injective, and two different type constructors cannot be convertible (no-confusion). Many consequences, including subject reduction.
[Normalisation] | Consequence of the logical relation: well-typed terms always reduce to a normal form.
[AlgorithmicTyping] | Definition of the second notion of typing: algorithmic typing (and algorithmic conversion together with it).
[BundledAlgorithmicTyping] | Algorithmic typing bundled with its pre-conditions, and a tailored induction principle showing invariant preservation in the "algorithm".
[AlgorithmicConvProperties] | Properties of algorithmic conversion, in order to derive the second instance of generic typing, consisting of declarative typing and algorithmic conversion, and completeness of algorithmic conversion. |
[AlgorithmicTypingProperties] |  Derive the third instance of generic typing, consisting entierly of algorithmic notions, and completeness of algorithmic typing. |

Decidability results
---------------

| File | Description |
|---|----|
[Functions] | Definition of the evaluation abstract machine, conversion checking and type-checking programs. Independent of the meta-theory: they are written in a monadic style with recursive call as a free effect.
[Soundness] | The functions are sound: when they succeed, their answer is correct, e.g. the term is typable.
[Completeness] | The functions are complete: they always return successfully when they should.
[Termination] | The functions always terminate.
[Decidability] | Top-level pure decision procedure for typing.


[Monad]: ../coq-partialfun/theories/Monad.v
[PartialFun]: ../coq-partialfun/theories/PartialFun.v
[Examples]: ../coq-partialfun/theories/Examples.v

[mapPiSigmaFunctorLaws]: ./coqdoc/LogRel.mapPiSigmaFunctorLaws.html
[Utils]: ./coqdoc/LogRel.Utils.html
[BasicAst]: ./coqdoc/LogRel.BasicAst.html
[Context]: ./coqdoc/LogRel.Context.html
[AutoSubst/]: ./theories/AutoSubst/
[AutoSubst/Extra]: ./coqdoc/LogRel.AutoSubst.Extra.html
[Notations]: ./coqdoc/LogRel.Notations.html
[NormalForms]: ./coqdoc/LogRel.NormalForms.html
[UntypedReduction]: ./coqdoc/LogRel.UntypedReduction.html
[GenericTyping]: ./coqdoc/LogRel.GenericTyping.html
[DeclarativeTyping]: ./coqdoc/LogRel.DeclarativeTyping.html
[Properties]: ./coqdoc/LogRel.Properties.html
[DeclarativeInstance]: ./coqdoc/LogRel.DeclarativeInstance.html
[LogicalRelation]: ./coqdoc/LogRel.LogicalRelation.html
[Induction]: ./coqdoc/LogRel.LogicalRelation.Induction.html
[Escape]: ./coqdoc/LogRel.LogicalRelation.Escape.html
[LogicalRelation.Reflexivity]: ./coqdoc/LogRel.LogicalRelation.Reflexivity.html
[LogicalRelation.Irrelevance]: ./coqdoc/LogRel.LogicalRelation.Irrelevance.html
[ShapeView]: ./coqdoc/LogRel.LogicalRelation.ShapeView.html
[Universe]: ./coqdoc/LogRel.LogicalRelation.Universe.html
[Neutral]: ./coqdoc/LogRel.LogicalRelation.Neutral.html
[Transitivity]: ./coqdoc/LogRel.LogicalRelation.Transitivity.html
[Reduction]: ./coqdoc/LogRel.LogicalRelation.Reduction.html
[NormalRed]: ./coqdoc/LogRel.LogicalRelation.NormalRed.html
[Application]: ./coqdoc/LogRel.LogicalRelation.Application.html
[SimpleArr]: ./coqdoc/LogRel.LogicalRelation.SimpleArr.html
[Validity]: ./coqdoc/LogRel.Validity.html
[Substitution.Irrelevance]: ./coqdoc/LogRel.Substitution.Irrelevance.html
[Substitution.Properties]: ./coqdoc/LogRel.Substitution.Properties.html
[Substitution.Escape]: ./coqdoc/LogRel.Substitution.Escape.html
[Substitution.Conversion]: ./coqdoc/LogRel.Substitution.Conversion.html
[Substitution.Reflexivity]: ./coqdoc/LogRel.Substitution.Reflexivity.html
[Substitution.Reduction]: ./coqdoc/LogRel.Substitution.Reduction.html
[SingleSubst]: ./coqdoc/LogRel.Substitution.SingleSubst.html
[Substitution.Introductions.*]: ./coqdoc/toc.html
[Fundamental]: ./coqdoc/LogRel.Fundamental.html
[Weakening]: ./coqdoc/LogRel.Weakening.html
[AlgorithmicTyping]: ./coqdoc/LogRel.AlgorithmicTyping.html
[AlgorithmicConvProperties]: ./coqdoc/LogRel.AlgorithmicConvProperties.html
[AlgorithmicTypingProperties]: ./coqdoc/LogRel.AlgorithmicTypingProperties.html
[LogRelConsequences]: ./coqdoc/LogRel.LogRelConsequences.html
[BundledAlgorithmicTyping]: ./coqdoc/LogRel.BundledAlgorithmicTyping.html
[DeclarativeSubst]: ./coqdoc/LogRel.DeclarativeSubst.html
[TypeConstructorsInj]: ./coqdoc/LogRel.TypeConstructorsInj.html
[Normalisation]: ./coqdoc/LogRel.Normalisation.html
[Functions]: ./coqdoc/LogRel.Decidability.Functions.html
[Soundness]: ./coqdoc/LogRel.Decidability.Soundness.html
[Completeness]: ./coqdoc/LogRel.Decidability.Completeness.html
[Termination]: ./coqdoc/LogRel.Decidability.Termination.html
[Decidability]: ./coqdoc/LogRel.Decidability.Decidability.html

[autosubst-ocaml]: https://github.com/uds-psl/autosubst-ocaml